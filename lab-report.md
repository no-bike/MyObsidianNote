



# 哈尔滨工业大学CS33503数据库系统实验报告

姓名：曲本磊

学号：2022112479

班级：2203501

专业：数据科学与大数据技术

学期：2024春

## 声明

本人承诺该实验全部由本人独立完成，没有抄袭他人代码。若被证实本人存在抄袭现象或为他人抄袭提供帮助，本人愿意承担全部责任（包括但不限于扣分、取消考试资格、上报学部等）。

## 目录

[TOC]

## 实验1：存储管理实验

### 任务1.1：磁盘存储管理器

在这一部分，你需要列举并介绍你实现的全部方法。你需要按照方法所在的类进行组织。在介绍每个方法的具体实现时，需要包含以下内容：

1. 方法的声明。给出方法的声明（注意：是方法声明，不是方法定义）。如果这个方法是你自己声明的，请说明它的功能以及为何要声明这个方法，何时调用这个方法。
2. 方法实现思路。根据方法实现的难度，可以采用不同的介绍形式。对于简单的方法，简要介绍方法的实现思路即可。对于复杂的方法，如果执行过程非常复杂，可以借助流程图或伪代码进行介绍。
3. 方法实现难点。如果你在实现这个方法的过程中遇到了较大的困难，不妨介绍一下你遇到的是什么困难，你最终的解决办法是什么。

#### DiskManager类的实现

```c++
void DiskManager::write_page(int fd, page_id_t page_no, const char *offset, int num_bytes);
```
将页面写入到磁盘中，需要使用lseek()函数定位文件头，利用句柄fd和偏离量。再通过write（）函数写入。

注意错误类型要选择正确。

```c++
void DiskManager::read_page(int fd, page_id_t page_no, char *offset, int num_bytes);
```
将页面写入到磁盘中，需要使用lseek()函数定位文件头，利用句柄fd和偏离量。再通过read（）函数写入。

注意错误类型要选择正确。

```c++
void DiskManager::create_file(const std::string &path) ;
```
这段C++代码是用来打开或创建一个文件的。它使用了`open`函数，这是一个在POSIX兼容的操作系统（如Linux和macOS）中常用的系统调用，用于打开和可能创建一个文件。

`open`函数的第一个参数是文件的路径，这里通过`path.c_str()`获取，其中`path`是一个`std::string`类型的变量，表示文件的路径。`c_str()`函数用于获取`std::string`的C风格字符串表示，因为`open`函数需要一个C风格的字符串作为路径参数。

第二个参数是一个位掩码，用于指定文件的打开方式和行为。在这个实现中，使用了`O_CREAT`和`O_WRONLY`两个选项的按位或（`|`）组合。`O_CREAT`表示如果指定的文件不存在，则创建它；`O_WRONLY`表示文件将以只写模式打开。这意味着如果文件已经存在，这段代码将打开它以便写入；如果文件不存在，将创建一个新文件，然后以只写模式打开。

```c++
void DiskManager::destroy_file(const std::string &path);
```

使用unlink函数来删除文件，但需要注意的是，如果指定的文件不存在，或者调用进程没有足够的权限来删除该文件，[`unlink`](command:_github.copilot.openSymbolFromReferences?%5B%7B%22%24mid%22%3A1%2C%22path%22%3A%22%2Fusr%2Finclude%2Funistd.h%22%2C%22scheme%22%3A%22file%22%7D%2C%7B%22line%22%3A857%2C%22character%22%3A11%7D%5D "../../../../../usr/include/unistd.h")函数将失败，并返回`-1`。成功执行时，它会返回`0`。
。
```c++
int DiskManager::open_file(const std::string &path);
```



```c++
page_id_t DiskManager::AllocatePage(int fd);
```



#### 实验发现

实验验证了哪些课堂上学到的理论知识？逐项说明，条理清晰，列出知识点与函数之间的对应关系。

- 
- 

### 任务1.2：缓冲池替换策略

#### LRUReplacer类的实现

内容

#### 实验发现

内容

### 任务1.3：缓冲池管理器

#### BufferPoolManager类的实现

内容

#### 实验发现

内容

### 任务2.1：记录操作


### 任务2.2 记录迭代器

## 实验2 索引管理器

### 任务1 B+树的查找

### 任务2 B+树的插入

### 任务3 B+树的删除

### 任务4 B+树索引并发控制
